diff --git a/ayanavita-fontend/src/api/spaAdmin.api.ts b/ayanavita-fontend/src/api/spaAdmin.api.ts
index c9a11ebef5a9c10a725aa0d08f8800b09d13f665..9f87a15beff89bc033ed5397ea76fa5fba4ff287 100644
--- a/ayanavita-fontend/src/api/spaAdmin.api.ts
+++ b/ayanavita-fontend/src/api/spaAdmin.api.ts
@@ -15,51 +15,51 @@ export type SpaService = {
   ratingAvg: number
   bookedCount: number
   imageUrl?: string
   tag?: string
   branchIds: number[]
 }
 export type PaginatedServiceResponse = {
   items: SpaService[]
   total: number
   page: number
   pageSize: number
   totalPages: number
 }

 export type ServiceCategory = {
   id: number
   name: string
   serviceCount: number
 }
 export type Specialist = {
   id: number
   code: string
   name: string
   level: string
   bio?: string
-  branchIds: number[]
+  branchId: number
   serviceIds: number[]
 }
 export type ServiceReview = {
   id: number
   serviceId: number
   userId?: number
   stars: number
   comment?: string
   customerName?: string
   createdAt: string
 }
 export type Appointment = {
   id: number
   customerName: string
   customerPhone: string
   customerEmail?: string
   appointmentAt: string
   status: string
   note?: string
   branch?: { id: number; name: string }
   service?: { id: number; name: string }
   specialist?: { id: number; name: string }
 }

 export const spaAdminApi = {
@@ -106,28 +106,31 @@ export const spaAdminApi = {
   },
   updateService: (id: number, data: Record<string, any>, file?: File | null) => {
     const form = new FormData()
     Object.entries(data).forEach(([key, value]) => {
       form.append(key, typeof value === 'string' ? value : JSON.stringify(value))
     })
     if (file) form.append('file', file)
     return request(`/booking/services/${id}`, { method: 'PATCH', body: form, auth: false })
   },
   deleteService: (id: number) => del(`/booking/services/${id}`, { auth: false }),

   createServiceCategory: (data: Partial<ServiceCategory>) => post('/booking/service-categories', data, { auth: false }),
   updateServiceCategory: (id: number, data: Partial<ServiceCategory>) => patch(`/booking/service-categories/${id}`, data, { auth: false }),
   deleteServiceCategory: (id: number) => del(`/booking/service-categories/${id}`, { auth: false }),

   createSpecialist: (data: any) => post('/booking/specialists', data, { auth: false }),
   updateSpecialist: (id: number, data: any) => patch(`/booking/specialists/${id}`, data, { auth: false }),
   deleteSpecialist: (id: number) => del(`/booking/specialists/${id}`, { auth: false }),

   createReview: (data: any) => post('/booking/service-reviews', data, { auth: false }),
   deleteReview: (id: number) => del(`/booking/service-reviews/${id}`, { auth: false }),

   updateAppointment: (id: number, data: any) => patch(`/booking/appointments/${id}`, data, { auth: false }),
   deleteAppointment: (id: number) => del(`/booking/appointments/${id}`, { auth: false }),

-  syncRelations: (payload: any) => post('/booking/relations/sync', payload, { auth: false }),
+  syncRelations: (payload: {
+    branchService?: Array<{ branchId: number; serviceId: number }>
+    specialistBranchService?: Array<{ specialistId: number; branchId: number; serviceId: number }>
+  }) => post('/booking/relations/sync', payload, { auth: false }),

 }
diff --git a/ayanavita-fontend/src/pages/admin/AdminSpaPage.tsx b/ayanavita-fontend/src/pages/admin/AdminSpaPage.tsx
index 3fdd52b6bb008cba2122340be4f4f8b0dd84ee2d..ec148a0a9a7a1b24df2db5ef98bfa0a1a7d07d96 100644
--- a/ayanavita-fontend/src/pages/admin/AdminSpaPage.tsx
+++ b/ayanavita-fontend/src/pages/admin/AdminSpaPage.tsx
@@ -1,42 +1,42 @@
 import { useEffect, useMemo, useState } from 'react'
 import { spaAdminApi, type Appointment, type Branch, type ServiceCategory, type ServiceReview, type SpaService, type Specialist } from '../../api/spaAdmin.api'
 import { AlertJs } from '../../utils/alertJs'
 import './AdminSpaPage.css'
 import { BranchesTab } from './tabs/BranchesTab'
 import { CategoriesTab } from './tabs/CategoriesTab'
 import { ReviewsTab } from './tabs/ReviewsTab'
 import { ServicesTab } from './tabs/ServicesTab'
 import { SpecialistsTab } from './tabs/SpecialistsTab'
 import type { BranchForm, CategoryForm, RelationForm, ReviewForm, ServiceForm, SpecialistForm } from './tabs/types'
 import { useAuth } from '../../state/auth.store'

 type TabKey = 'branches' | 'categories' | 'services' | 'specialists' | 'reviews'

 const defaultServiceForm: ServiceForm = { name: '', description: '', categoryId: 0, goals: '', suitableFor: '', process: '', durationMin: 60, price: 0, tag: 'Spa' }
 const defaultCategoryForm: CategoryForm = { name: '' }
-const defaultSpecialistForm: SpecialistForm = { code: '', name: '', level: 'SENIOR', bio: '' }
+const defaultSpecialistForm: SpecialistForm = { code: '', name: '', level: 'SENIOR', bio: '', branchId: 0 }
 const defaultReviewForm: ReviewForm = { serviceId: 0, stars: 5, comment: '', customerName: '' }
 const defaultBranchForm: BranchForm = { code: '', name: '', address: '', phone: '', isActive: true }


 const normalizeBranchCode = (name: string) => {
   const base = name
     .normalize('NFD')
     .replace(/[ÃÄ-ÕØ]/g, '')
     .replace(/ƒë/gi, 'd')
     .toUpperCase()
     .replace(/[^A-Z0-9]+/g, '_')
     .replace(/^_+|_+$/g, '')

   return base || 'BRANCH'
 }


 const isValidPhoneNumber = (phone: string) => {
   const cleaned = phone.trim()
   if (!cleaned) return true
   if (!/^\+?[\d\s().-]+$/.test(cleaned)) return false
   const digitsCount = cleaned.replace(/\D/g, '').length
   return digitsCount >= 6 && digitsCount <= 20
 }

@@ -331,78 +331,81 @@ export default function AdminSpaPage() {
         } catch (error) {
           await AlertJs.error('L∆∞u d·ªãch v·ª• th·∫•t b·∫°i', getVietnameseError(error, 'Vui l√≤ng ki·ªÉm tra l·∫°i th√¥ng tin d·ªãch v·ª•.'))
         }
       }} onEditService={(service) => {
         setEditingService(service)
         setSelectedImage(null)
         setServiceForm({
           ...defaultServiceForm,
           ...service,
           categoryId: service.categoryId || 0,
           goals: service.goals?.join(', ') || '',
           suitableFor: service.suitableFor?.join(', ') || '',
           process: service.process?.join(', ') || '',
         })
       }} onDeleteService={async (service) => {
         try {
           await spaAdminApi.deleteService(service.id)
           await loadAll()
           await AlertJs.success('ƒê√£ x√≥a d·ªãch v·ª•')
         } catch (error) {
           await AlertJs.error('X√≥a d·ªãch v·ª• th·∫•t b·∫°i', getVietnameseError(error, 'D·ªãch v·ª• ƒëang ƒë∆∞·ª£c s·ª≠ d·ª•ng ho·∫∑c c√≥ l·ªói h·ªá th·ªëng.'))
         }
       }} onCancelEdit={() => { setEditingService(null); setServiceForm(defaultServiceForm); setSelectedImage(null) }} />}

       {tab === 'specialists' && <SpecialistsTab loading={loading} branches={activeBranches} services={services} specialists={specialists} specialistForm={specialistForm} relationForm={relationForm} editingSpecialist={editingSpecialist} onSpecialistFormChange={setSpecialistForm} onRelationFormChange={setRelationForm} onSaveSpecialist={async () => {
+        if (!specialistForm.branchId) {
+          await AlertJs.error('Thi·∫øu chi nh√°nh', 'Vui l√≤ng ch·ªçn chi nh√°nh cho chuy√™n vi√™n.')
+          return
+        }
         try {
           if (editingSpecialist) await spaAdminApi.updateSpecialist(editingSpecialist.id, specialistForm)
           else await spaAdminApi.createSpecialist(specialistForm)
           setEditingSpecialist(null)
           setSpecialistForm(defaultSpecialistForm)
           await loadAll()
           await AlertJs.success('ƒê√£ l∆∞u chuy√™n vi√™n')
         } catch (error) {
           await AlertJs.error('L∆∞u chuy√™n vi√™n th·∫•t b·∫°i', getVietnameseError(error, 'Th√¥ng tin chuy√™n vi√™n ch∆∞a h·ª£p l·ªá.'))
         }
-      }} onEditSpecialist={(specialist) => { setEditingSpecialist(specialist); setSpecialistForm({ code: specialist.code, name: specialist.name, level: specialist.level, bio: specialist.bio || '' }) }} onDeleteSpecialist={async (specialist) => {
+      }} onEditSpecialist={(specialist) => { setEditingSpecialist(specialist); setSpecialistForm({ code: specialist.code, name: specialist.name, level: specialist.level, bio: specialist.bio || '', branchId: specialist.branchId }) }} onDeleteSpecialist={async (specialist) => {
         try {
           await spaAdminApi.deleteSpecialist(specialist.id)
           await loadAll()
           await AlertJs.success('ƒê√£ x√≥a chuy√™n vi√™n')
         } catch (error) {
           await AlertJs.error('X√≥a chuy√™n vi√™n th·∫•t b·∫°i', getVietnameseError(error, 'Chuy√™n vi√™n ƒëang c√≥ l·ªãch h·∫πn ho·∫∑c li√™n k·∫øt d·ªØ li·ªáu.'))
         }
       }} onShowSpecialistDetail={(specialist) => { void AlertJs.info(`Chuy√™n vi√™n: ${specialist.name}`, specialist.bio || 'Kh√¥ng c√≥ m√¥ t·∫£ chi ti·∫øt.') }} onSaveRelation={async () => {
         if (!relationForm.branchId || !relationForm.serviceId || !relationForm.specialistId) {
           await AlertJs.error('Thi·∫øu d·ªØ li·ªáu', 'Vui l√≤ng ch·ªçn ƒë·∫ßy ƒë·ªß chi nh√°nh, d·ªãch v·ª• v√† chuy√™n vi√™n.')
           return
         }
         try {
           await spaAdminApi.syncRelations({
             branchService: [{ branchId: relationForm.branchId, serviceId: relationForm.serviceId }],
-            serviceSpecialist: [{ serviceId: relationForm.serviceId, specialistId: relationForm.specialistId }],
-            branchSpecialist: [{ branchId: relationForm.branchId, specialistId: relationForm.specialistId }],
+            specialistBranchService: [{ specialistId: relationForm.specialistId, branchId: relationForm.branchId, serviceId: relationForm.serviceId }],
           })
           await loadAll()
           await AlertJs.success('ƒê√£ l∆∞u quan h·ªá')
         } catch (error) {
           await AlertJs.error('L∆∞u quan h·ªá th·∫•t b·∫°i', getVietnameseError(error, 'Kh√¥ng th·ªÉ ƒë·ªìng b·ªô quan h·ªá d·ªØ li·ªáu.'))
         }
       }} onCancelEdit={() => { setEditingSpecialist(null); setSpecialistForm(defaultSpecialistForm) }} />}

       {tab === 'reviews' && <ReviewsTab loading={loading} services={services} appointments={appointments} selectedServiceReviews={selectedServiceReviews} reviewForm={reviewForm} onReviewFormChange={setReviewForm} onCreateReview={async () => {
         try {
           await spaAdminApi.createReview(reviewForm)
           setReviewForm(defaultReviewForm)
           await loadAll()
           await AlertJs.success('ƒê√£ th√™m review')
         } catch (error) {
           await AlertJs.error('Th√™m review th·∫•t b·∫°i', getVietnameseError(error, 'Vui l√≤ng ki·ªÉm tra n·ªôi dung review.'))
         }
       }} onDeleteReview={async (review) => {
         try {
           await spaAdminApi.deleteReview(review.id)
           await loadAll()
           await AlertJs.success('ƒê√£ x√≥a review')
         } catch (error) {
           await AlertJs.error('X√≥a review th·∫•t b·∫°i', getVietnameseError(error, 'Kh√¥ng th·ªÉ x√≥a review v√†o l√∫c n√†y.'))
         }
diff --git a/ayanavita-fontend/src/pages/admin/tabs/ServicesTab.tsx b/ayanavita-fontend/src/pages/admin/tabs/ServicesTab.tsx
index 83def6cfa9327d21606558c23c22a3e2b86e457b..d0a7d20303d38578b21f275bbbcd8cbc0d9d453a 100644
--- a/ayanavita-fontend/src/pages/admin/tabs/ServicesTab.tsx
+++ b/ayanavita-fontend/src/pages/admin/tabs/ServicesTab.tsx
@@ -294,51 +294,51 @@ export function ServicesTab({
                 <div className='service-detail-grid'>
                   <article className='service-detail-card'>
                     <h4><i className='fa-solid fa-clipboard-list' /> Th√¥ng tin nhanh</h4>
                     <p><b>ID:</b> {detailService.id}</p>
                     <p><b>Danh m·ª•c:</b> {detailService.category || '-'}</p>
                     <p><b>Tag:</b> {detailService.tag || '-'}</p>
                     <p><b>M√¥ t·∫£:</b> {detailService.description || '-'}</p>
                   </article>

                   <article className='service-detail-card'>
                     <h4><i className='fa-solid fa-file-lines' /> N·ªôi dung d·ªãch v·ª•</h4>
                     <p><b>M·ª•c ti√™u:</b></p>
                     {renderDetailLines(detailService.goals || [])}
                     <p><b>Ph√π h·ª£p:</b></p>
                     {renderDetailLines(detailService.suitableFor || [])}
                     <p><b>Quy tr√¨nh:</b></p>
                     {renderDetailLines(detailService.process || [])}
                   </article>

                   <article className='service-detail-card service-branch-specialists-card'>
                     <h4><i className='fa-solid fa-building-circle-check' /> Chi nh√°nh & chuy√™n vi√™n theo d·ªãch v·ª•</h4>
                     {detailBranches.length > 0
                       ? (
                         <ul className='service-branch-list'>
                           {detailBranches.map((branch) => {
-                            const specialistsByBranch = detailSpecialists.filter((specialist) => specialist.branchIds.includes(branch.id))
+                            const specialistsByBranch = detailSpecialists.filter((specialist) => specialist.branchId === branch.id)
                             return (
                               <li key={branch.id} className='service-branch-item'>
                                 <div className='service-branch-line'>
                                   <i className='fa-solid fa-building service-branch-icon' />
                                   <span><b>{branch.name}</b> ‚Ä¢ {branch.address}</span>
                                 </div>
                                 <ul className='service-specialist-sublist'>
                                   {specialistsByBranch.length > 0
                                     ? specialistsByBranch.map((specialist) => (
                                       <li key={specialist.id} className='service-specialist-subitem'>
                                         <i className='fa-solid fa-user-doctor service-specialist-icon' />
                                         <span>{specialist.name} ({specialist.level})</span>
                                       </li>
                                     ))
                                     : <li className='service-specialist-subitem service-detail-empty-item'><i className='fa-regular fa-circle-xmark service-specialist-icon' /><span>Ch∆∞a c√≥ chuy√™n vi√™n cho d·ªãch v·ª• n√†y t·∫°i chi nh√°nh.</span></li>}
                                 </ul>
                               </li>
                             )
                           })}
                         </ul>
                       )
                       : <p className='service-detail-empty'>Ch∆∞a c√≥ chi nh√°nh li√™n k·∫øt.</p>}
                   </article>

                   <article className='service-detail-card'>
diff --git a/ayanavita-fontend/src/pages/admin/tabs/SpecialistsTab.tsx b/ayanavita-fontend/src/pages/admin/tabs/SpecialistsTab.tsx
index cb280d185f45d1454baa36d92695a0a8fc9d789f..85a50c907982d6f8e824b2589e6c38cc7a30a397 100644
--- a/ayanavita-fontend/src/pages/admin/tabs/SpecialistsTab.tsx
+++ b/ayanavita-fontend/src/pages/admin/tabs/SpecialistsTab.tsx
@@ -1,64 +1,69 @@
 import type { SpecialistsTabProps } from './types'

 export function SpecialistsTab({ branches, services, specialists, specialistForm, relationForm, editingSpecialist, onSpecialistFormChange, onRelationFormChange, onSaveSpecialist, onEditSpecialist, onDeleteSpecialist, onShowSpecialistDetail, onSaveRelation, onCancelEdit }: SpecialistsTabProps) {
+  const branchSpecialists = relationForm.branchId
+    ? specialists.filter((item) => item.branchId === relationForm.branchId)
+    : specialists
+
   return (
     <div className='admin-grid'>
       <section className='admin-card admin-card-glow'>
         <h3 className='admin-card-title'><i className='fa-solid fa-user-nurse' /> {editingSpecialist ? 'C·∫≠p nh·∫≠t chuy√™n vi√™n' : 'Th√™m chuy√™n vi√™n'}</h3>
         <div className='admin-form-grid'>
           <label className='admin-field'><span className='admin-label'><i className='fa-solid fa-id-card' /> Code</span><input className='admin-input' placeholder='SPEC_001' value={specialistForm.code} onChange={(e) => onSpecialistFormChange({ ...specialistForm, code: e.target.value })} /></label>
           <label className='admin-field'><span className='admin-label'><i className='fa-solid fa-user' /> T√™n chuy√™n vi√™n</span><input className='admin-input' placeholder='T√™n chuy√™n vi√™n' value={specialistForm.name} onChange={(e) => onSpecialistFormChange({ ...specialistForm, name: e.target.value })} /></label>
+          <label className='admin-field'><span className='admin-label'><i className='fa-solid fa-building' /> Chi nh√°nh</span><select className='admin-input' value={specialistForm.branchId} onChange={(e) => onSpecialistFormChange({ ...specialistForm, branchId: Number(e.target.value) })}><option value={0}>Ch·ªçn chi nh√°nh</option>{branches.map((b) => <option key={b.id} value={b.id}>{b.name}</option>)}</select></label>
           <label className='admin-field'><span className='admin-label'><i className='fa-solid fa-medal' /> C·∫•p ƒë·ªô</span><select className='admin-input' value={specialistForm.level} onChange={(e) => onSpecialistFormChange({ ...specialistForm, level: e.target.value })}><option value='THERAPIST'>THERAPIST</option><option value='SENIOR'>SENIOR</option><option value='EXPERT'>EXPERT</option></select></label>
           <label className='admin-field'><span className='admin-label'><i className='fa-solid fa-address-card' /> Bio</span><textarea className='admin-input' placeholder='M√¥ t·∫£ nƒÉng l·ª±c chuy√™n vi√™n' value={specialistForm.bio} onChange={(e) => onSpecialistFormChange({ ...specialistForm, bio: e.target.value })} /></label>
         </div>
         <div className='admin-row'>
           <button className='admin-btn admin-btn-primary' onClick={onSaveSpecialist}>{editingSpecialist ? 'L∆∞u thay ƒë·ªïi' : 'Th√™m chuy√™n vi√™n'}</button>
           {editingSpecialist && <button className='admin-btn admin-btn-ghost' onClick={onCancelEdit}>H·ªßy</button>}
         </div>

         <hr className='admin-divider' />
-        <h4 className='admin-subtitle'><i className='fa-solid fa-link' /> G√°n quan h·ªá N-N</h4>
+        <h4 className='admin-subtitle'><i className='fa-solid fa-link' /> G√°n chuy√™n vi√™n cho d·ªãch v·ª• theo chi nh√°nh</h4>
         <div className='admin-form-grid'>
-          <label className='admin-field'><span className='admin-label'><i className='fa-solid fa-building' /> Chi nh√°nh</span><select className='admin-input' value={relationForm.branchId} onChange={(e) => onRelationFormChange({ ...relationForm, branchId: Number(e.target.value) })}><option value={0}>Ch·ªçn chi nh√°nh</option>{branches.map((b) => <option key={b.id} value={b.id}>{b.name}</option>)}</select></label>
+          <label className='admin-field'><span className='admin-label'><i className='fa-solid fa-building' /> Chi nh√°nh</span><select className='admin-input' value={relationForm.branchId} onChange={(e) => onRelationFormChange({ ...relationForm, branchId: Number(e.target.value), specialistId: 0 })}><option value={0}>Ch·ªçn chi nh√°nh</option>{branches.map((b) => <option key={b.id} value={b.id}>{b.name}</option>)}</select></label>
           <label className='admin-field'><span className='admin-label'><i className='fa-solid fa-spa' /> D·ªãch v·ª•</span><select className='admin-input' value={relationForm.serviceId} onChange={(e) => onRelationFormChange({ ...relationForm, serviceId: Number(e.target.value) })}><option value={0}>Ch·ªçn d·ªãch v·ª•</option>{services.map((s) => <option key={s.id} value={s.id}>{s.name}</option>)}</select></label>
-          <label className='admin-field'><span className='admin-label'><i className='fa-solid fa-user-nurse' /> Chuy√™n vi√™n</span><select className='admin-input' value={relationForm.specialistId} onChange={(e) => onRelationFormChange({ ...relationForm, specialistId: Number(e.target.value) })}><option value={0}>Ch·ªçn chuy√™n vi√™n</option>{specialists.map((s) => <option key={s.id} value={s.id}>{s.name}</option>)}</select></label>
+          <label className='admin-field'><span className='admin-label'><i className='fa-solid fa-user-nurse' /> Chuy√™n vi√™n</span><select className='admin-input' value={relationForm.specialistId} onChange={(e) => onRelationFormChange({ ...relationForm, specialistId: Number(e.target.value) })}><option value={0}>Ch·ªçn chuy√™n vi√™n</option>{branchSpecialists.map((s) => <option key={s.id} value={s.id}>{s.name}</option>)}</select></label>
         </div>
         <button className='admin-btn admin-btn-ghost' onClick={onSaveRelation}><i className='fa-solid fa-floppy-disk' />L∆∞u quan h·ªá</button>
       </section>

       <section className='admin-card'>
         <h3 className='admin-card-title'><i className='fa-solid fa-table-list' /> Danh s√°ch chuy√™n vi√™n</h3>
         <div className='admin-table-wrap'>
           <table className='admin-table'>
             <thead>
               <tr>
                 <th>T√™n</th>
                 <th>C·∫•p ƒë·ªô</th>
                 <th>Chi nh√°nh</th>
                 <th>D·ªãch v·ª•</th>
                 <th>Thao t√°c</th>
               </tr>
             </thead>
             <tbody>
               {specialists.map((item) => (
                 <tr key={item.id}>
                   <td className='td-strong'>{item.name}</td>
                   <td><span className={`admin-badge ${item.level === 'EXPERT' ? 'admin-badge-purple' : item.level === 'SENIOR' ? 'admin-badge-blue' : 'admin-badge-pastel'}`}>{item.level}</span></td>
-                  <td>{item.branchIds.join(', ') || '-'}</td>
+                  <td>{item.branchId || '-'}</td>
                   <td>{item.serviceIds.join(', ') || '-'}</td>
                   <td>
                     <div className='admin-row'>
                       <button className='admin-btn admin-btn-ghost' onClick={() => onEditSpecialist(item)}>S·ª≠a</button>
                       <button className='admin-btn admin-btn-ghost' onClick={() => onShowSpecialistDetail(item)}>Chi ti·∫øt</button>
                       <button className='admin-btn admin-btn-danger' onClick={() => onDeleteSpecialist(item)}>X√≥a</button>
                     </div>
                   </td>
                 </tr>
               ))}
             </tbody>
           </table>
         </div>
       </section>
     </div>
   )
 }
diff --git a/ayanavita-fontend/src/pages/admin/tabs/types.ts b/ayanavita-fontend/src/pages/admin/tabs/types.ts
index 2de291577767bdb485107db4da5ecb0f04ddb4ff..fec91248190b54bb8b58c6479d2d608d3aba2067 100644
--- a/ayanavita-fontend/src/pages/admin/tabs/types.ts
+++ b/ayanavita-fontend/src/pages/admin/tabs/types.ts
@@ -1,44 +1,44 @@
 import type { Appointment, Branch, ServiceCategory, ServiceReview, SpaService, Specialist } from '../../../api/spaAdmin.api'

 export type BranchForm = Partial<Branch>
 export type ServiceForm = {
   name: string
   description: string
   categoryId: number
   goals: string
   suitableFor: string
   process: string
   durationMin: number
   price: number
   tag: string
 }
 export type CategoryForm = {
   name: string
 }

-export type SpecialistForm = { code: string; name: string; level: string; bio: string }
+export type SpecialistForm = { code: string; name: string; level: string; bio: string; branchId: number }
 export type ReviewForm = { serviceId: number; stars: number; comment: string; customerName: string }
 export type RelationForm = { branchId: number; serviceId: number; specialistId: number }

 export type CommonTabProps = {
   loading: boolean
 }

 export type BranchesTabProps = CommonTabProps & {
   branches: Branch[]
   branchForm: BranchForm
   editingBranch: Branch | null
   onBranchFormChange: (next: BranchForm) => void
   onSaveBranch: () => Promise<void>
   onEditBranch: (branch: Branch) => void
   onDeleteBranch: (branch: Branch) => Promise<void>
   onCancelEdit: () => void
 }

 export type ServicesTabProps = CommonTabProps & {
   services: SpaService[]
   categories: ServiceCategory[]
   serviceForm: ServiceForm
   editingService: SpaService | null
   selectedImageName: string
   searchKeyword: string
diff --git a/backend/ayanavitabackend/app/api/prisma/migrations/202602260004_specialist_branch_refactor/migration.sql b/backend/ayanavitabackend/app/api/prisma/migrations/202602260004_specialist_branch_refactor/migration.sql
new file mode 100644
index 0000000000000000000000000000000000000000..99b1717ea12182be8b1365a33cff1ef8fbe854d0
--- /dev/null
+++ b/backend/ayanavitabackend/app/api/prisma/migrations/202602260004_specialist_branch_refactor/migration.sql
@@ -0,0 +1,43 @@
+-- Add branchId to Specialist
+ALTER TABLE `Specialist` ADD COLUMN `branchId` INTEGER NULL;
+
+UPDATE `Specialist` s
+LEFT JOIN (
+  SELECT `specialistId`, MIN(`branchId`) AS `branchId`
+  FROM `BranchSpecialist`
+  GROUP BY `specialistId`
+) bs ON bs.`specialistId` = s.`id`
+SET s.`branchId` = COALESCE(bs.`branchId`, (SELECT `id` FROM `Branch` ORDER BY `id` ASC LIMIT 1))
+WHERE s.`branchId` IS NULL;
+
+ALTER TABLE `Specialist` MODIFY `branchId` INTEGER NOT NULL;
+CREATE INDEX `Specialist_branchId_idx` ON `Specialist`(`branchId`);
+
+-- New relation table: Specialist N-N BranchService
+CREATE TABLE `SpecialistBranchService` (
+  `specialistId` INTEGER NOT NULL,
+  `branchId` INTEGER NOT NULL,
+  `serviceId` INTEGER NOT NULL,
+  `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
+
+  INDEX `SpecialistBranchService_branchId_serviceId_idx`(`branchId`, `serviceId`),
+  PRIMARY KEY (`specialistId`, `branchId`, `serviceId`)
+) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
+
+INSERT IGNORE INTO `SpecialistBranchService` (`specialistId`, `branchId`, `serviceId`)
+SELECT ss.`specialistId`, sp.`branchId`, ss.`serviceId`
+FROM `ServiceSpecialist` ss
+INNER JOIN `Specialist` sp ON sp.`id` = ss.`specialistId`
+INNER JOIN `BranchService` bs ON bs.`branchId` = sp.`branchId` AND bs.`serviceId` = ss.`serviceId`;
+
+ALTER TABLE `Specialist` ADD CONSTRAINT `Specialist_branchId_fkey`
+  FOREIGN KEY (`branchId`) REFERENCES `Branch`(`id`) ON DELETE RESTRICT ON UPDATE CASCADE;
+
+ALTER TABLE `SpecialistBranchService` ADD CONSTRAINT `SpecialistBranchService_specialistId_fkey`
+  FOREIGN KEY (`specialistId`) REFERENCES `Specialist`(`id`) ON DELETE CASCADE ON UPDATE CASCADE;
+ALTER TABLE `SpecialistBranchService` ADD CONSTRAINT `SpecialistBranchService_branchId_serviceId_fkey`
+  FOREIGN KEY (`branchId`, `serviceId`) REFERENCES `BranchService`(`branchId`, `serviceId`) ON DELETE CASCADE ON UPDATE CASCADE;
+
+-- Remove old incorrect relation tables
+DROP TABLE `ServiceSpecialist`;
+DROP TABLE `BranchSpecialist`;
diff --git a/backend/ayanavitabackend/app/api/prisma/schema.prisma b/backend/ayanavitabackend/app/api/prisma/schema.prisma
index 038c2e110fd45649e884f5341d5caf64837c4d1a..722a4b969e471e108f04bd68336edafb7e882bb1 100644
--- a/backend/ayanavitabackend/app/api/prisma/schema.prisma
+++ b/backend/ayanavitabackend/app/api/prisma/schema.prisma
@@ -20,137 +20,129 @@ model User {
   createdAt          DateTime @default(now())
   updatedAt          DateTime @updatedAt

   // ‚úÖ ADD
   enrollments    Enrollment[]
   lessonProgress LessonProgress[]
   orders         Order[] // <‚Äî opposite for Order.user

   // ‚úÖ CMS (optional relations)
   cmsSectionVersions CmsSectionVersion[]
   mediaAssets        MediaAsset[]
   appointments       Appointment[]
   serviceReviews     ServiceReview[]
 }

 model Branch {
   id          Int                @id @default(autoincrement())
   code        String             @unique @db.VarChar(32)
   name        String             @db.VarChar(255)
   address     String             @db.VarChar(255)
   phone       String?            @db.VarChar(30)
   isActive    Boolean            @default(true)
   createdAt   DateTime           @default(now())
   updatedAt   DateTime           @updatedAt
   services    BranchService[]
-  specialists BranchSpecialist[]
+  specialists Specialist[]
   appointments Appointment[]
 }

 model ServiceCategory {
   id        Int      @id @default(autoincrement())
   name      String   @unique @db.VarChar(255)
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
   services  Service[]
 }

 model Service {
   id           Int                 @id @default(autoincrement())
   name         String              @db.VarChar(255)
   description  String?             @db.Text
   categoryId   Int?
   goals        Json?
   suitableFor  Json?
   process      Json?
   durationMin  Int
   price        Int                 @default(0)
   ratingAvg    Float               @default(5)
   bookedCount  Int                 @default(0)
   tag          String?             @db.VarChar(80)
   imageUrl     String?             @db.VarChar(500)
   isActive     Boolean             @default(true)
   createdAt    DateTime            @default(now())
   updatedAt    DateTime            @updatedAt
   category     ServiceCategory?    @relation(fields: [categoryId], references: [id], onDelete: SetNull)
   branches     BranchService[]
-  specialists  ServiceSpecialist[]
   appointments Appointment[]
   reviews      ServiceReview[]

   @@index([categoryId])
 }

 model Specialist {
   id          Int                 @id @default(autoincrement())
   code        String              @unique @db.VarChar(32)
   name        String              @db.VarChar(255)
+  branchId    Int
   level       SpecialistLevel     @default(SENIOR)
   bio         String?             @db.Text
   avatarUrl   String?             @db.VarChar(500)
   isActive    Boolean             @default(true)
   createdAt   DateTime            @default(now())
   updatedAt   DateTime            @updatedAt
-  services    ServiceSpecialist[]
-  branches    BranchSpecialist[]
+  branch      Branch              @relation(fields: [branchId], references: [id], onDelete: Restrict)
+  serviceLinks SpecialistBranchService[]
   appointments Appointment[]
+
+  @@index([branchId])
 }

 model BranchService {
   branchId  Int
   serviceId Int
   createdAt DateTime @default(now())

   branch  Branch  @relation(fields: [branchId], references: [id], onDelete: Cascade)
   service Service @relation(fields: [serviceId], references: [id], onDelete: Cascade)
+  specialistLinks SpecialistBranchService[]

   @@id([branchId, serviceId])
   @@index([serviceId])
 }

-model ServiceSpecialist {
-  serviceId    Int
+model SpecialistBranchService {
   specialistId Int
-  createdAt    DateTime @default(now())
-
-  service    Service    @relation(fields: [serviceId], references: [id], onDelete: Cascade)
-  specialist Specialist @relation(fields: [specialistId], references: [id], onDelete: Cascade)
-
-  @@id([serviceId, specialistId])
-  @@index([specialistId])
-}
-
-model BranchSpecialist {
   branchId     Int
-  specialistId Int
+  serviceId    Int
   createdAt    DateTime @default(now())

-  branch     Branch     @relation(fields: [branchId], references: [id], onDelete: Cascade)
-  specialist Specialist @relation(fields: [specialistId], references: [id], onDelete: Cascade)
+  specialist Specialist   @relation(fields: [specialistId], references: [id], onDelete: Cascade)
+  branchService BranchService @relation(fields: [branchId, serviceId], references: [branchId, serviceId], onDelete: Cascade)

-  @@id([branchId, specialistId])
-  @@index([specialistId])
+  @@id([specialistId, branchId, serviceId])
+  @@index([branchId, serviceId])
 }

 model Appointment {
   id            Int               @id @default(autoincrement())
   code          String            @unique @db.VarChar(40)
   customerName  String            @db.VarChar(255)
   customerPhone String            @db.VarChar(30)
   customerEmail String?           @db.VarChar(255)
   appointmentAt DateTime
   note          String?           @db.Text
   status        AppointmentStatus @default(PENDING)
   branchId      Int
   serviceId     Int
   specialistId  Int?
   userId        Int?
   createdAt     DateTime          @default(now())
   updatedAt     DateTime          @updatedAt

   branch     Branch      @relation(fields: [branchId], references: [id], onDelete: Restrict)
   service    Service     @relation(fields: [serviceId], references: [id], onDelete: Restrict)
   specialist Specialist? @relation(fields: [specialistId], references: [id], onDelete: SetNull)
   user       User?       @relation(fields: [userId], references: [id], onDelete: SetNull)

   @@index([branchId, appointmentAt])
   @@index([serviceId])
diff --git a/backend/ayanavitabackend/app/api/prisma/seed.ts b/backend/ayanavitabackend/app/api/prisma/seed.ts
index 1dd1ed6446674e576af1c3f26a0da43620c862c9..c406d3e97d394f3859f60a1f0eb4293669fb93f0 100644
--- a/backend/ayanavitabackend/app/api/prisma/seed.ts
+++ b/backend/ayanavitabackend/app/api/prisma/seed.ts
@@ -74,122 +74,136 @@ async function main() {
       goals: ['relax', 'pain'],
       suitableFor: ['D√¢n vƒÉn ph√≤ng', 'Hay ƒëau ƒë·∫ßu'],
       durationMin: 60,
       price: 320000,
       ratingAvg: 4.8,
       bookedCount: 2100,
       tag: 'Hot',
       imageUrl: 'https://images.unsplash.com/photo-1596178060671-7a80dc8059ea?auto=format&fit=crop&w=1200&q=70',
       description: 'K·∫øt h·ª£p massage da ƒë·∫ßu v√† tinh d·∫ßu gi√∫p gi·∫£m cƒÉng th·∫≥ng.',
     },
     {
       name: 'Combo da + massage ‚ú®',
       categoryName: 'Combo li·ªáu tr√¨nh',
       goals: ['restore', 'relax'],
       suitableFor: ['C·∫ßn ph·ª•c h·ªìi to√†n di·ªán', 'Thi·∫øu th·ªùi gian'],
       durationMin: 120,
       price: 1050000,
       ratingAvg: 4.9,
       bookedCount: 420,
       tag: 'Combo',
       imageUrl: 'https://images.unsplash.com/photo-1556228453-efd6c1ff04f6?auto=format&fit=crop&w=1200&q=70',
       description: 'K·∫øt h·ª£p chƒÉm s√≥c da v√† massage tr·ªã li·ªáu trong m·ªôt bu·ªïi.',
     },
   ]

-  const specialistSeeds: Array<{ code: string; name: string; level: SpecialistLevel; bio: string }> = [
-    { code: 'LINH', name: 'Chuy√™n vi√™n Linh', level: SpecialistLevel.SENIOR, bio: '8 nƒÉm kinh nghi·ªám chƒÉm s√≥c da.' },
-    { code: 'TRANG', name: 'Chuy√™n vi√™n Trang', level: SpecialistLevel.EXPERT, bio: 'Chuy√™n gia massage tr·ªã li·ªáu.' },
-    { code: 'MAI', name: 'Chuy√™n vi√™n Mai', level: SpecialistLevel.SENIOR, bio: 'T∆∞ v·∫•n li·ªáu tr√¨nh ph·ª•c h·ªìi da.' },
-    { code: 'NAM', name: 'Chuy√™n vi√™n Nam', level: SpecialistLevel.THERAPIST, bio: 'K·ªπ thu·∫≠t vi√™n tr·ªã li·ªáu c·ªï vai g√°y.' },
+  const specialistSeeds: Array<{ code: string; name: string; level: SpecialistLevel; bio: string; branchCode: string }> = [
+    { code: 'LINH', name: 'Chuy√™n vi√™n Linh', level: SpecialistLevel.SENIOR, bio: '8 nƒÉm kinh nghi·ªám chƒÉm s√≥c da.', branchCode: 'HCM_Q1' },
+    { code: 'TRANG', name: 'Chuy√™n vi√™n Trang', level: SpecialistLevel.EXPERT, bio: 'Chuy√™n gia massage tr·ªã li·ªáu.', branchCode: 'HN_CG' },
+    { code: 'MAI', name: 'Chuy√™n vi√™n Mai', level: SpecialistLevel.SENIOR, bio: 'T∆∞ v·∫•n li·ªáu tr√¨nh ph·ª•c h·ªìi da.', branchCode: 'DN_HC' },
+    { code: 'NAM', name: 'Chuy√™n vi√™n Nam', level: SpecialistLevel.THERAPIST, bio: 'K·ªπ thu·∫≠t vi√™n tr·ªã li·ªáu c·ªï vai g√°y.', branchCode: 'HCM_Q1' },
   ]

   for (const b of branchSeeds) {
     await prisma.branch.upsert({ where: { code: b.code }, update: b, create: b })
   }

   const categorySeeds = [
     { name: 'ChƒÉm s√≥c da' },
     { name: 'ChƒÉm s√≥c c∆° th·ªÉ' },
     { name: 'D∆∞·ª°ng sinh' },
     { name: 'Combo li·ªáu tr√¨nh' },
     { name: 'Kh√°c' },
   ]

   for (const c of categorySeeds) {
     await prisma.serviceCategory.upsert({ where: { name: c.name }, update: c, create: c })
   }

   const categories = await prisma.serviceCategory.findMany()
   const categoryMap = new Map(categories.map((c) => [c.name, c.id]))

   for (const s of serviceSeeds) {
     const { categoryName, ...serviceData } = s
     const categoryId = categoryMap.get(categoryName) ?? categoryMap.get('Kh√°c')
     const existingService = await prisma.service.findFirst({ where: { name: s.name } })
     if (existingService) {
       await prisma.service.update({
         where: { id: existingService.id },
         data: { ...serviceData, categoryId },
       })
     } else {
       await prisma.service.create({ data: { ...serviceData, categoryId } })
     }
   }

+  const branches = await prisma.branch.findMany()
+  const branchByCode = new Map(branches.map((item) => [item.code, item.id]))
+
   for (const st of specialistSeeds) {
-    await prisma.specialist.upsert({ where: { code: st.code }, update: st, create: st })
+    const branchId = branchByCode.get(st.branchCode)
+    if (!branchId) continue
+    const { branchCode, ...specialistData } = st
+    await prisma.specialist.upsert({
+      where: { code: st.code },
+      update: { ...specialistData, branchId },
+      create: { ...specialistData, branchId },
+    })
   }

-  const branches = await prisma.branch.findMany()
   const services = await prisma.service.findMany()
   const specialists = await prisma.specialist.findMany()

   for (const branch of branches) {
     for (const service of services) {
       await prisma.branchService.upsert({
         where: { branchId_serviceId: { branchId: branch.id, serviceId: service.id } },
         update: {},
         create: { branchId: branch.id, serviceId: service.id },
       })
     }
-
-    for (const specialist of specialists) {
-      await prisma.branchSpecialist.upsert({
-        where: { branchId_specialistId: { branchId: branch.id, specialistId: specialist.id } },
-        update: {},
-        create: { branchId: branch.id, specialistId: specialist.id },
-      })
-    }
   }

   for (const specialist of specialists) {
-    for (const service of services) {
-      await prisma.serviceSpecialist.upsert({
-        where: { serviceId_specialistId: { serviceId: service.id, specialistId: specialist.id } },
+    const branchServices = services.filter((_, index) => index % 2 === specialist.id % 2)
+    const allowedServices = branchServices.length > 0 ? branchServices : services.slice(0, 1)
+
+    for (const service of allowedServices) {
+      await prisma.specialistBranchService.upsert({
+        where: {
+          specialistId_branchId_serviceId: {
+            specialistId: specialist.id,
+            branchId: specialist.branchId,
+            serviceId: service.id,
+          },
+        },
         update: {},
-        create: { serviceId: service.id, specialistId: specialist.id },
+        create: {
+          specialistId: specialist.id,
+          branchId: specialist.branchId,
+          serviceId: service.id,
+        },
       })
     }
   }

   const now = new Date()
   const sampleAppointments = [
     {
       code: 'APM-1001',
       customerName: 'Nguy·ªÖn Thu H√†',
       customerPhone: '0912000111',
       customerEmail: 'thuha@example.com',
       appointmentAt: new Date(now.getTime() + 24 * 60 * 60 * 1000),
       note: 'Da nh·∫°y c·∫£m, c·∫ßn t∆∞ v·∫•n k·ªπ.',
       branchId: branches[0]?.id,
       serviceId: services[0]?.id,
       specialistId: specialists[0]?.id,
       userId: user.id,
     },
     {
       code: 'APM-1002',
       customerName: 'Tr·∫ßn Minh Anh',
       customerPhone: '0912000222',
       customerEmail: 'minhanh@example.com',
       appointmentAt: new Date(now.getTime() + 2 * 24 * 60 * 60 * 1000),
       note: '∆Øu ti√™n khung gi·ªù chi·ªÅu ü§ó',
diff --git a/backend/ayanavitabackend/app/api/src/booking/booking.service.ts b/backend/ayanavitabackend/app/api/src/booking/booking.service.ts
index 603386f24678160e5b95e5241c62b0a438d0fe3e..3556a7a3b6ebdba9582ebf9fe33f00a34dbc9f39 100644
--- a/backend/ayanavitabackend/app/api/src/booking/booking.service.ts
+++ b/backend/ayanavitabackend/app/api/src/booking/booking.service.ts
@@ -268,73 +268,73 @@ export class BookingService {
       goals: this.toStringArray(s.goals),
       suitableFor: this.toStringArray(s.suitableFor),
       process: this.toStringArray(s.process),
       durationMin: s.durationMin,
       price: s.price,
       ratingAvg: s.ratingAvg,
       bookedCount: s.bookedCount,
       tag: s.tag,
       imageUrl: s.imageUrl,
       branchIds: s.branches.map((b) => b.branchId),
     }))

     return {
       items,
       total,
       page,
       pageSize,
       totalPages: Math.max(1, Math.ceil(total / pageSize)),
     }
   }

   async listSpecialists(branchId?: number, serviceId?: number): Promise<SpecialistResponseDto[]> {
     const rows = await this.prisma.specialist.findMany({
       where: {
         isActive: true,
-        ...(branchId ? { branches: { some: { branchId } } } : {}),
-        ...(serviceId ? { services: { some: { serviceId } } } : {}),
+        ...(branchId ? { branchId } : {}),
+        ...(serviceId ? { serviceLinks: { some: { serviceId } } } : {}),
       },
       select: {
         id: true,
         code: true,
         name: true,
         level: true,
         bio: true,
-        branches: { select: { branchId: true } },
-        services: { select: { serviceId: true } },
+        branchId: true,
+        serviceLinks: { select: { serviceId: true } },
       },
       orderBy: { id: 'asc' },
     })

     return rows.map((s) => ({
       id: s.id,
       code: s.code,
       name: s.name,
       level: s.level,
       bio: s.bio,
-      branchIds: s.branches.map((b) => b.branchId),
-      serviceIds: s.services.map((srv) => srv.serviceId),
+      branchId: s.branchId,
+      serviceIds: [...new Set(s.serviceLinks.map((srv) => srv.serviceId))],
     }))
   }


   listAppointments(userId?: number) {
     return this.prisma.appointment.findMany({
       where: userId ? { userId } : {},
       include: {
         branch: { select: { id: true, name: true } },
         service: { select: { id: true, name: true, durationMin: true, price: true } },
         specialist: { select: { id: true, name: true, level: true } },
       },
       orderBy: { appointmentAt: 'desc' },
     })
   }
   async listServiceReviews(serviceId?: number): Promise<ServiceReviewResponseDto[]> {
     const rows = await this.prisma.serviceReview.findMany({
       where: serviceId ? { serviceId } : {},
       select: {
         id: true,
         serviceId: true,
         userId: true,
         stars: true,
         comment: true,
         customerName: true,
@@ -350,61 +350,60 @@ export class BookingService {
     const appointmentAt = new Date(dto.appointmentAt)
     if (Number.isNaN(appointmentAt.getTime())) {
       throw new BadRequestException('Invalid appointmentAt date')
     }

     const [branch, service] = await Promise.all([
       this.prisma.branch.findUnique({ where: { id: dto.branchId } }),
       this.prisma.service.findUnique({ where: { id: dto.serviceId } }),
     ])

     if (!branch) throw new NotFoundException('Branch not found')
     if (!service) throw new NotFoundException('Service not found')

     const branchService = await this.prisma.branchService.findUnique({
       where: { branchId_serviceId: { branchId: dto.branchId, serviceId: dto.serviceId } },
     })

     if (!branchService) {
       throw new BadRequestException('Service is not available in this branch')
     }

     if (dto.specialistId) {
       const specialist = await this.prisma.specialist.findUnique({ where: { id: dto.specialistId } })
       if (!specialist) throw new NotFoundException('Specialist not found')

-      const [branchLink, serviceLink] = await Promise.all([
-        this.prisma.branchSpecialist.findUnique({
-          where: { branchId_specialistId: { branchId: dto.branchId, specialistId: dto.specialistId } },
-        }),
-        this.prisma.serviceSpecialist.findUnique({
-          where: { serviceId_specialistId: { serviceId: dto.serviceId, specialistId: dto.specialistId } },
-        }),
-      ])
-
-      if (!branchLink || !serviceLink) {
-        throw new BadRequestException('Specialist is not available for branch/service')
+      if (specialist.branchId !== dto.branchId) {
+        throw new BadRequestException('Specialist does not belong to this branch')
+      }
+
+      const specialistBranchService = await this.prisma.specialistBranchService.findUnique({
+        where: { specialistId_branchId_serviceId: { specialistId: dto.specialistId, branchId: dto.branchId, serviceId: dto.serviceId } },
+      })
+
+      if (!specialistBranchService) {
+        throw new BadRequestException('Specialist is not available for this service in selected branch')
       }
     }

     const created = await this.prisma.appointment.create({
       data: {
         code: `APM-${Date.now()}`,
         customerName: dto.customerName,
         customerPhone: dto.customerPhone,
         customerEmail: dto.customerEmail,
         appointmentAt,
         note: dto.note,
         branchId: dto.branchId,
         serviceId: dto.serviceId,
         specialistId: dto.specialistId,
         userId: dto.userId,
       },
       include: {
         branch: { select: { id: true, name: true } },
         service: { select: { id: true, name: true, durationMin: true, price: true } },
         specialist: { select: { id: true, name: true, level: true } },
       },
     })

     return created
   }
@@ -502,111 +501,133 @@ export class BookingService {
       data: {
         ...(data.name !== undefined ? { name: String(data.name).trim() } : {}),
       },
     })
   }

   async deleteServiceCategory(id: number) {
     const linkedServices = await this.prisma.service.count({ where: { categoryId: id } })
     if (linkedServices > 0) {
       throw new BadRequestException('Danh m·ª•c ƒëang c√≥ d·ªãch v·ª•, kh√¥ng th·ªÉ x√≥a')
     }

     await this.prisma.serviceCategory.delete({ where: { id } })
     return { ok: true }
   }

   async createBranch(data: any) {
     return this.prisma.branch.create({ data })
   }

   async updateBranch(id: number, data: any) {
     return this.prisma.branch.update({ where: { id }, data })
   }

   async deleteBranch(id: number) {
-    const [branchServiceCount, branchSpecialistCount, appointmentCount] = await Promise.all([
+    const [branchServiceCount, specialistCount, specialistServiceCount, appointmentCount] = await Promise.all([
       this.prisma.branchService.count({ where: { branchId: id } }),
-      this.prisma.branchSpecialist.count({ where: { branchId: id } }),
+      this.prisma.specialist.count({ where: { branchId: id } }),
+      this.prisma.specialistBranchService.count({ where: { branchId: id } }),
       this.prisma.appointment.count({ where: { branchId: id } }),
     ])

-    const linkedCount = branchServiceCount + branchSpecialistCount + appointmentCount
+    const linkedCount = branchServiceCount + specialistCount + specialistServiceCount + appointmentCount
     if (linkedCount > 0) {
       await this.prisma.branch.update({ where: { id }, data: { isActive: false } })
       return {
         ok: true,
         softDeleted: true,
         message: 'Chi nh√°nh ƒëang c√≥ li√™n k·∫øt d·ªØ li·ªáu. H·ªá th·ªëng ƒë√£ t·ª± ƒë·ªông chuy·ªÉn tr·∫°ng th√°i sang kh√¥ng ho·∫°t ƒë·ªông.',
       }
     }

     await this.prisma.branch.delete({ where: { id } })
     return { ok: true, softDeleted: false }
   }

   async createSpecialist(data: any) {
-    return this.prisma.specialist.create({ data })
+    const branchId = Number(data.branchId)
+    if (!Number.isInteger(branchId) || branchId < 1) {
+      throw new BadRequestException('branchId is required')
+    }
+
+    return this.prisma.specialist.create({ data: { ...data, branchId } })
   }

   async updateSpecialist(id: number, data: any) {
-    return this.prisma.specialist.update({ where: { id }, data })
+    const payload = { ...data }
+    if (payload.branchId !== undefined) {
+      const branchId = Number(payload.branchId)
+      if (!Number.isInteger(branchId) || branchId < 1) {
+        throw new BadRequestException('branchId is invalid')
+      }
+      payload.branchId = branchId
+    }
+
+    return this.prisma.specialist.update({ where: { id }, data: payload })
   }

   async deleteSpecialist(id: number) {
     await this.prisma.specialist.delete({ where: { id } })
     return { ok: true }
   }

   async createServiceReview(data: any) {
     const created = await this.prisma.serviceReview.create({ data })
     const stats = await this.prisma.serviceReview.aggregate({
       where: { serviceId: created.serviceId },
       _avg: { stars: true },
       _count: { id: true },
     })
     await this.prisma.service.update({
       where: { id: created.serviceId },
       data: {
         ratingAvg: stats._avg.stars ?? 5,
       },
     })
     return created
   }

   async deleteServiceReview(id: number) {
     await this.prisma.serviceReview.delete({ where: { id } })
     return { ok: true }
   }

   async upsertRelations(payload: {
     branchService?: Array<{ branchId: number; serviceId: number }>
-    serviceSpecialist?: Array<{ serviceId: number; specialistId: number }>
-    branchSpecialist?: Array<{ branchId: number; specialistId: number }>
+    specialistBranchService?: Array<{ specialistId: number; branchId: number; serviceId: number }>
   }) {
-    const { branchService = [], serviceSpecialist = [], branchSpecialist = [] } = payload
+    const { branchService = [], specialistBranchService = [] } = payload

     for (const item of branchService) {
       await this.prisma.branchService.upsert({
         where: { branchId_serviceId: item },
         update: {},
         create: item,
       })
     }
-    for (const item of serviceSpecialist) {
-      await this.prisma.serviceSpecialist.upsert({
-        where: { serviceId_specialistId: item },
+
+    for (const item of specialistBranchService) {
+      const specialist = await this.prisma.specialist.findUnique({ where: { id: item.specialistId }, select: { id: true, branchId: true } })
+      if (!specialist) {
+        throw new NotFoundException(`Specialist ${item.specialistId} not found`)
+      }
+      if (specialist.branchId !== item.branchId) {
+        throw new BadRequestException('Specialist can only be assigned to services in their own branch')
+      }
+
+      await this.prisma.branchService.upsert({
+        where: { branchId_serviceId: { branchId: item.branchId, serviceId: item.serviceId } },
         update: {},
-        create: item,
+        create: { branchId: item.branchId, serviceId: item.serviceId },
       })
-    }
-    for (const item of branchSpecialist) {
-      await this.prisma.branchSpecialist.upsert({
-        where: { branchId_specialistId: item },
+
+      await this.prisma.specialistBranchService.upsert({
+        where: { specialistId_branchId_serviceId: item },
         update: {},
         create: item,
       })
     }

-    return { ok: true, branchService: branchService.length, serviceSpecialist: serviceSpecialist.length, branchSpecialist: branchSpecialist.length }
+    return { ok: true, branchService: branchService.length, specialistBranchService: specialistBranchService.length }
   }
 }
diff --git a/backend/ayanavitabackend/app/api/src/booking/dto/booking-response.dto.ts b/backend/ayanavitabackend/app/api/src/booking/dto/booking-response.dto.ts
index b1a5a251f5c775a41253f6e30f2dbcd1245c377a..aaf229c1d6803ddc6b11e9fc64b5829833323b4e 100644
--- a/backend/ayanavitabackend/app/api/src/booking/dto/booking-response.dto.ts
+++ b/backend/ayanavitabackend/app/api/src/booking/dto/booking-response.dto.ts
@@ -37,44 +37,44 @@ export class ServiceResponseDto {
   tag?: string | null
   imageUrl?: string | null
   branchIds!: number[]
 }

 export class ServiceListResponseDto {
   items!: ServiceResponseDto[]
   total!: number
   page!: number
   pageSize!: number
   totalPages!: number
 }

 export class ServiceCategoryResponseDto {
   id!: number
   name!: string
   serviceCount!: number
 }

 export class SpecialistResponseDto {
   id!: number
   code!: string
   name!: string
   level!: string
   bio?: string | null
-  branchIds!: number[]
+  branchId!: number
   serviceIds!: number[]
 }

 export class ServiceReviewResponseDto {
   id!: number
   serviceId!: number
   userId?: number | null
   stars!: number
   comment?: string | null
   customerName?: string | null
   createdAt!: Date
 }

 export class TempImageResponseDto {
   fileName!: string
   url!: string
   size!: number
 }
